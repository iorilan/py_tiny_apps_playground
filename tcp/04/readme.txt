handle multi-connection using select
outputs with queue